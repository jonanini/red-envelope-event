<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>抽紅包活動</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 20px;
    }
    .red-envelope {
      margin-top: 20px;
      padding: 10px 20px;
      background-color: red;
      color: white;
      border-radius: 10px;
      cursor: pointer;
    }
    .disabled {
      background-color: gray;
      cursor: not-allowed;
    }
    .winner-form {
      display: none;
      margin-top: 20px;
      text-align: left;
    }
    .form-field {
      margin-bottom: 10px;
    }
    .form-field label {
      display: block;
      font-weight: bold;
    }
    .form-field input {
      width: 100%;
      padding: 5px;
    }
  </style>
</head>
<body>
  <h1>抽紅包活動</h1>
  <p id="activity-period"></p>
  <div>
    <label>每日抽獎次數限制：</label>
    <input type="number" id="daily-limit" value="3">
  </div>
  <div>
    <label>中獎機率 (0-100%)：</label>
    <input type="number" id="winning-rate" value="50">
  </div>
  <div>
    <label>新增獎項：</label>
    <input type="text" id="prize-input" placeholder="輸入獎項">
    <button onclick="addPrize()">新增</button>
  </div>
  <div>
    <h3>獎項清單</h3>
    <ul id="prize-list"></ul>
  </div>
  <button class="red-envelope" onclick="drawPrize()">抽紅包</button>
  <p id="result"></p>
  <button onclick="shareActivity()">分享活動</button>

  <!-- 中獎者表單 -->
  <div class="winner-form" id="winner-form">
    <h3>請填寫領獎人資訊</h3>
    <div class="form-field">
      <label for="name">姓名：</label>
      <input type="text" id="name" required>
    </div>
    <div class="form-field">
      <label for="phone">電話：</label>
      <input type="text" id="phone" required>
    </div>
    <div class="form-field">
      <label for="address">地址：</label>
      <input type="text" id="address" required>
    </div>
    <div class="form-field">
      <label for="email">Email：</label>
      <input type="email" id="email" required>
    </div>
    <button onclick="submitWinnerInfo()">提交</button>
  </div>

  <script>
    const startDate = new Date();
    const endDate = new Date();
    endDate.setDate(startDate.getDate() + 7); // 活動結束日期（7天後）
    const prizeList = [];
    let dailyDraws = 0;

    document.getElementById("activity-period").innerText = 
      `活動期間：${startDate.toLocaleDateString()} - ${endDate.toLocaleDateString()}`;

    function addPrize() {
      const prize = document.getElementById("prize-input").value;
      if (prize) {
        prizeList.push(prize);
        const listItem = document.createElement("li");
        listItem.textContent = prize;
        document.getElementById("prize-list").appendChild(listItem);
        document.getElementById("prize-input").value = "";
      } else {
        alert("請輸入獎項！");
      }
    }

    function drawPrize() {
      const today = new Date();
      if (today > endDate) {
        document.getElementById("result").innerText = "活動已結束！";
        return;
      }

      const dailyLimit = parseInt(document.getElementById("daily-limit").value);
      const winningRate = parseInt(document.getElementById("winning-rate").value);

      if (dailyDraws >= dailyLimit) {
        document.getElementById("result").innerText = "您今日的抽獎次數已達上限！";
        return;
      }

      dailyDraws++;
      const randomNum = Math.random() * 100;

      if (randomNum < winningRate && prizeList.length > 0) {
        const randomIndex = Math.floor(Math.random() * prizeList.length);
        const prize = prizeList[randomIndex];
        document.getElementById("result").innerText = `恭喜您獲得：${prize}`;
        showWinnerForm(); // 顯示領獎人表單
      } else {
        document.getElementById("result").innerText = "很遺憾，您沒有中獎！";
      }
    }

    function showWinnerForm() {
      document.getElementById("winner-form").style.display = "block";
    }

    function submitWinnerInfo() {
      const name = document.getElementById("name").value;
      const phone = document.getElementById("phone").value;
      const address = document.getElementById("address").value;
      const email = document.getElementById("email").value;

      if (!name || !phone || !address || !email) {
        alert("請填寫完整資訊！");
        return;
      }

      // 模擬提交領獎資訊
      console.log("領獎人資訊：", { name, phone, address, email });
      alert("領獎資訊已提交，感謝參與！");
      document.getElementById("winner-form").style.display = "none";
    }

    function shareActivity() {
      const shareText = `快來參加抽紅包活動吧！活動期間：${startDate.toLocaleDateString()} - ${endDate.toLocaleDateString()}`;
      navigator.share
        ? navigator.share({ title: "抽紅包活動", text: shareText, url: window.location.href })
        : alert("分享功能僅限於支援的瀏覽器！");
    }
  </script>
</body>
</html>
